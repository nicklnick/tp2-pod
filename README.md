# POD TP2: Parking infractions
The goal of this project is to process parking ticket data based on real-world datasets from the cities of New York and Chicago by designing and implementing a console application that utilizes the MapReduce programming model along with the Hazelcast framework.
## Prerequisites
* Maven
* Java 17 or higher
## Installation
Inside the project folder:
```bash
mvn clean package	# get the server and client
tar -xzvf ./server/target/tpe2-g1-server-2024.1Q-bin.tar.gz
tar -xzvf ./client/target/tpe2-g1-client-2024.1Q-bin.tar.gz
```
## Run the Server
Grant permissions before running:
```bash
cd tpe2-g1-server-2024.1Q
chmod u+x run-server.sh
sh run-server.sh -Dport=<"portNumber">
```

## Executing Queries
```bash
chmod u+x tpe2-g1-client-2024.1Q/*
cd tpe2-g1-client-2024.1Q
```
All queries can be run as follows:
```bash
sh queryX.sh -Daddresses="<addresses>" -Dcity=[NYC|CHI] -DinPath="<inPath>" -DoutPath="<outPath>" [params]
```
- `-Daddresses` specifies the IP addresses and ports of the Hazelcast nodes, separated by semicolons.
- `-Dcity` indicates the city for which the data is being processed.
- `-DinPath` denotes the directory path where the input files are located.
- `-DoutPath` denotes the directory path where the output files `queryX.csv` and `timeX.txt` will be saved.

### Query 1: Total fines per infraction
Outputs the infraction and the total number of fines for it, sorted in descending order by the total number of fines, with ties broken alphabetically by the infraction.
```bash
sh query1.sh -Daddresses="<addresses>" -Dcity=[NYC|CHI] -DinPath="<inPath>" -DoutPath="<outPath>"
```
### Query 2: Top 3 common infractions per county
Outputs county names with their top 3 common infractions, sorted alphabetically by the county name.
```bash
sh query2.sh -Daddresses="<addresses>" -Dcity=[NYC|CHI] -DinPath="<inPath>" -DoutPath="<outPath>"
```
### Query 3: Top N agencies by revenue
Outputs the name and revenue percentage generated by the top N agencies, sorted in descending order by revenue percentage, with ties broken sorting alphabetically by name.
```bash
sh query3.sh -Daddresses="<addresses>" -Dcity=[NYC|CHI] -DinPath="<inPath>" -DoutPath="<outPath>" -Dn="<N>"
```
* `-Dn` indicates the number of agencies to output.
### Query 4: Plate with most infractions per county
Outputs county names alongside the license plate with the most infractions in a certain date range, with the corresponding number of violations, sorted alphabetically by neighborhood.
```bash
sh query4.sh -Daddresses="<addresses>" -Dcity=[NYC|CHI] -DinPath="<inPath>" -DoutPath="<outPath>" -Dfrom="<fromDate>" -Dto="<toDate>"
```
* `-Dfrom` indicates the earliest date accepted in the range, in `dd/MM/yyyy` format.
* `-Dto` indicates the latest date accepted in the range, in `dd/MM/yyyy` format.
### Query 5: Pairs of infractions with the same average fine amount
Outputs groups of hundreds representing the same average fine amount for infractions A and B, with the names of said infractions, sorted in descending order by the group of hundreds. Within each group, the pairs are sorted alphabetically by infraction name.
```bash
sh query5.sh -Daddresses="<addresses>" -Dcity=[NYC|CHI] -DinPath="<inPath>" -DoutPath="<outPath>"
```